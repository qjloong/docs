# 分布式架构总览

## 分布式文件系统

> FastDFS是一款开源的轻量级分布式文件系统纯C实现，支持Linux、FreeBSD等UNIX系统类google FS，不是通用的文件系统，
只能通过专有API访问，目前提供了C、Java和PHP API为互联网应用量身定做，解决大容量文件存储问题，
追求高性能和高扩展性FastDFS可以看做是基于文件的key value pair存储系统，称作分布式文件存储服务更为合适。
------ 来自官网介绍

这是一个高性能的轻量级开源分布式文件系统，解决了我们日常项目中众所周知的文件存储性能问题。

与单机文件系统的对比

文件系统|高可用|扩展|部署复杂程度|性能
--|---|---|---|---
单机文件系统|	低，依赖于单机服务器，只要服务器崩溃，完全不可用。|	低，要扩容只能停机增加硬盘。|	低	|当文件数量多到一定的程度，磁盘IO寻址操作将会成为瓶颈
分布式文件系统|	高，一个group内的服务器崩溃后，group内的其他storage将接管服务。|	高，可以不停机增加group机器。|	高，部署较复杂|	高，通过集群或者分布式的方式分担服务器的压力。


## 小规模企业最佳部署方案

<img src="images/dfs-1.png" class="img-responsive" alt="">

应用服务器部署fastdfs的tracker节点，App应用服务器及nginx反向代理服务器

192.168.1.188，192.168.1.189安装fastdfs的存储节点，默认分一组，一组内两台机器互为备份.

注意：为了做到高可用，一个group建议分为两台以上的机器。


## 分布式服务常用部署方案

<img src="images/dfs-2.png" class="img-responsive" alt="">

应用服务器、存储服务器单机或分组部署

默认部署在企业局域网，私有云服务内网访问

注意：如需要对外开放访问，可通过配置外网访问插件实现


<img src="images/dfs-3.png" class="img-responsive" alt="">


高可用最少包含两台以上机器

双机分别部署应用服务、数据库、存储，如硬件资源充裕，也可应用、存储分别独立部署

注意：高可用模式分主备高可用模式和双主高可用模式，可根据实际需求自由配置


<img src="images/dfs-4.png" class="img-responsive" alt="">

集群部署模式是分布式架构的大型方案

应用服务、数据库服务多台部署，存储服务多个分组部署


<img src="images/dfs-5.png" class="img-responsive" alt="">

总部与分布跨区域部署，总部和分布分别独立部署

总部数据中心与分布数据中心数据通过网络专线同步

